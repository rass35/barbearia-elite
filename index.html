const catalog = document.getElementById('catalog');

fetch(jsonUrl)
  .then(response => {
    if (!response.ok) throw new Error('Erro ao carregar servi√ßos');
    return response.json();
  })
  .then(data => {
    service.innerHTML = '<option value="">Selecione</option>';
    catalog.innerHTML = '';

    Object.keys(data).forEach(categoria => {
      // Cat√°logo visual
      const bloco = document.createElement('div');
      bloco.innerHTML = `<h3 style="margin: 1rem 0 0.5rem; border-bottom: 1px solid #555;">${categoria}</h3>`;
      data[categoria].forEach(item => {
        const linha = document.createElement('div');
        linha.style.display = 'flex';
        linha.style.justifyContent = 'space-between';
        linha.style.padding = '4px 0';
        linha.innerHTML = `<span>${item.name}</span><span style="color:#0f0;font-weight:bold">R$ ${item.price}</span>`;
        bloco.appendChild(linha);
      });
      catalog.appendChild(bloco);

      // Select dropdown
      const optgroup = document.createElement('optgroup');
      optgroup.label = categoria;
      data[categoria].forEach(item => {
        const option = document.createElement('option');
        option.value = item.name;
        option.textContent = `${item.name} - üí∞ R$${item.price}`;
        optgroup.appendChild(option);
      });
      service.appendChild(optgroup);
    });
  })
  .catch(err => {
    console.error(err);
    service.innerHTML = '<option value="">Erro ao carregar servi√ßos</option>';
    catalog.innerHTML = '<p style="color:red">Erro ao carregar cat√°logo</p>';
  });
